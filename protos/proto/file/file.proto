syntax = "proto3";

package file;

option go_package = "github.com/datapeice/astolfosplayer-backend/protos/gen/go/file";

service FileService {
    rpc Upload (stream UploadRequest) returns (UploadResponse);
    rpc Download (DownloadRequest) returns (stream DownloadResponse);
    rpc Delete (DeleteRequest) returns (DeleteResponse);
}

message UploadRequest {
    oneof data {
        FileMetadata metadata = 1;
        bytes chunk = 2;
    }
}

message FileMetadata {
    string filename = 1;
    string title = 2;
    string artist = 3;
    string album = 4;
    int32 duration = 5;
}

message UploadResponse {
    string hash = 1;
}

message DownloadRequest {
    string hash = 1;
}

message DownloadResponse {
    bytes chunk = 1;
}

message DeleteRequest {
    string hash = 1;
}

message DeleteResponse {
    bool success = 1;
}